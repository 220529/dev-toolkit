const { Controller } = require('egg');
const fs = require('fs');
const xlsx = require('node-xlsx');
class ApiController extends Controller {
    async runFlow() {
        const { ctx } = this;
        let body = ctx.request.body
        let jsData = fs.readFileSync(body.dataPath, 'utf8')
        // /api/open/runFlow
        // 输出获取到的数据
        const data = { ...body, data: jsData }
        try {
            const response = await ctx.app.curl(`${data.hostPre}/api/open/runFlow`, {
                method: 'POST',
                contentType: 'json',
                dataType: 'json',
                headers: {
                    'Content-Type': 'application/json',
                    'Accept': '*/*',
                    'Host': data.host,
                    'Connection': 'keep-alive',
                },
                data: data
            });
            console.log(response.data)
            ctx.body = response.data;
        } catch (error) {
            ctx.logger.error(error);
            ctx.body = { error: 'Failed to fetch data' };
        }

    }
    async getData(orderIds) {
        const { ctx } = this;
        const response = await ctx.app.curl(`https://erp.tone.top/api/runFlow`, {
            method: 'POST',
            contentType: 'json',
            dataType: 'json',
            headers: {
                'Content-Type': 'application/json',
                'Authorization': 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6NDA4MSwibmFtZSI6IuW0lOe6ouaelyIsIm1vYmlsZSI6ImN1aWhvbmdsaW4iLCJpc0FjdGl2ZSI6dHJ1ZSwic3VwcGxpZXJJZCI6bnVsbCwiY29tcGFueUlkIjowLCJkZXBhcnRtZW50SWQiOiIwIiwicm9sZXMiOiIxIiwiY3VyUm9sZSI6MSwid3h1c2VyaWQiOiIxNTczNTQwMTEyNiIsImF1dG9Mb2dpbiI6ZmFsc2UsInBvc2l0aW9uIjoiIiwicHdkVmVyc2lvbiI6MiwibG9naW5Ub2tlblR5cGUiOiJ3eCIsImxvZ2luUmVxdWVzdElkIjoiYzhmNGRlYjktN2M3YS00NWZmLThlOWQtMTQ5YzRlNjYxNmEyIiwiaWF0IjoxNzUzMjQ5ODkwLCJleHAiOjE3NTM4NTQ2OTB9.RNSkGlEI5hX70KK1zVN-Y_RFbnCDIB02AM3U_5EO-CY',
                'app-version': 'v1.1.91',
                'Accept': '*/*',
                'Connection': 'keep-alive',
            },
            timeout: 100000,
            data: {
                "flowId": "o9ko11b72shzq0jr",
                "orderIds": orderIds
            }
        });
        return response.data;

    }
    async aaaa() {
        const { ctx } = this;
        const columns = [
            {
                title: '订单号',
                field: 'number',
                width: '230px',
            },
            {
                title: '是否确认业绩',
                field: 'isConfirm',
                width: '120px',
            },
            {
                title: '是否已开工',
                field: 'isStart',
                width: '120px',
            },
            {
                title: '是否已排期',
                field: 'isScheduling',
                width: '120px',
            },
            {
                title: '是否已退单',
                field: 'completed',
                width: '120px',
            },
            {
                title: '客户姓名',
                field: 'customerName',
                width: '130px',
            },
            {
                title: '客户电话',
                field: 'customerPhone',
                width: '160px',
            },
            {
                title: '门店',
                field: 'storeAffiliation',
                width: '160px',
            },
            {
                title: '设计部',
                field: 'designGroupName',
                width: '160px',
            },
            {
                title: '设计师',
                field: 'designName',
                width: '140px',
            },
            {
                title: '渠道部',
                field: 'channelGroupName',
                width: '160px',
            },
            {
                title: '渠道专员',
                field: 'channelName',
                width: '160px',
            },
            {
                title: '签约类型',
                field: 'thaLiType',
                width: '150px',
            },

            {
                title: '签约面积',
                field: 'area',
                width: '110px',
            },
            {
                title: '签单额',
                field: 'signingAmount',
                width: '120px',
            },
            {
                title: '实缴金额',
                field: 'actualAmount',
                width: '120px',
            },
            {
                title: '签单时间',
                field: 'signOrderTime',
                width: '120px',
            },
        ];
        const titles = columns.map(item => item.title);
        const fields = columns.map(item => item.field);
        const data = [titles];
        const orderIds = [
        451,
        5664,
        5747,
        5949,
        6591,
        7041,
        7392,
        7958,
        8880,
        8893,
        9163,
        9166,
        9234,
        9240,
        9808,
        9851,
        10786,
        10798,
        10806,
        11052,
        11094,
        11356,
        11603,
        11641,
        11775,
        11951,
        12011,
        12105,
        12221,
        12342,
        12387,
        12549,
        12692,
        12704,
        12723,
        12726,
        12730,
        12782,
        12803,
        12870,
        12874,
        12877,
        12912,
        12977,
        13004,
        13010,
        13060,
        13061,
        13062,
        13063,
        13064,
        13065,
        13066,
        13067,
        13069,
        13070,
        13072,
        13073,
        13074,
        13075,
        13076,
        13077,
        13078,
        13079,
        13080,
        13081,
        13083,
        13088,
        13089,
        13091,
        13092,
        13098,
        13099,
        13102,
        13105,
        13107,
        13108,
        13111,
        13115,
        13118,
        13119,
        13125,
        13127,
        13132,
        13133,
        13134,
        13137,
        13138,
        13144,
        13145,
        13148,
        13149,
        13151,
        13152,
        13154,
        13156,
        13158,
        13161,
        13163,
        13164,
        13165,
        13167,
        13168,
        13170,
        13172,
        13173,
        13175,
        13176,
        13178,
        13179,
        13180,
        13181,
        13184,
        13185,
        13186,
        13188,
        13190,
        13192,
        13193,
        13196,
        13197,
        13199,
        13202,
        13204,
        13205,
        13206,
        13208,
        13209,
        13211,
        13212,
        13213,
        13214,
        13215,
        13216,
        13217,
        13218,
        13219,
        13220,
        13221,
        13222,
        13225,
        13226,
        13229,
        13230,
        13231,
        13232,
        13234,
        13241,
        13242,
        13244,
        13246,
        13247,
        13248,
        13249,
        13250,
        13251,
        13252,
        13254,
        13255,
        13257,
        13259,
        13260,
        13261,
        13263,
        13265,
        13266,
        13267,
        13269,
        13270,
        13271,
        13272,
        13273,
        13274,
        13275,
        13276,
        13277,
        13278,
        13279,
        13280,
        13281,
        13282,
        13283,
        13284,
        13285,
        13286,
        13287,
        13288,
        13289,
        13290,
        13291,
        13292,
        13293,
        13294,
        13295,
        13296,
        13297,
        13298,
        13299,
        13300,
        13301,
        13302,
        13303,
        13304,
        13306,
        13309,
        13310,
        13312,
        13313,
        13317,
        13319,
        13322,
        13325,
        13328,
        13330,
        13332,
        13334,
        13335,
        13336,
        13337,
        13341,
        13342,
        13343,
        13344,
        13347,
        13348,
        13350,
        13352,
        13353,
        13355,
        13356,
        13357,
        13359,
        13360,
        13361,
        13363,
        13364,
        13365,
        13367,
        13368,
        13369,
        13370,
        13373,
        13374,
        13375,
        13377,
        13379,
        13380,
        13382,
        13383,
        13384,
        13386,
        13387,
        13388,
        13389,
        13390,
        13392,
        13394,
        13396,
        13397,
        13402,
        13403,
        13405,
        13406,
        13407,
        13409,
        13410,
        13411,
        13414,
        13416,
        13417,
        13419,
        13420,
        13422,
        13423,
        13424,
        13426,
        13427,
        13429,
        13431,
        13432,
        13433,
        13434,
        13437,
        13438,
        13440,
        13442,
        13443,
        13444,
        13450,
        13451,
        13452,
        13453,
        13454,
        13455,
        13456,
        13457,
        13458,
        13460,
        13461,
        13462,
        13464,
        13466,
        13467,
        13468,
        13469,
        13470,
        13472,
        13473,
        13474,
        13475,
        13476,
        13477,
        13478,
        13479,
        13480,
        13481,
        13482,
        13484,
        13485,
        13487,
        13488,
        13489,
        13490,
        13491,
        13492,
        13493,
        13494,
        13495,
        13496,
        13500,
        13501,
        13504,
        13505,
        13506,
        13507,
        13510,
        13511,
        13512,
        13513,
        13515,
        13517,
        13521,
        13522,
        13524,
        13526,
        13527,
        13528,
        13529,
        13530,
        13533,
        13538,
        13539,
        13542,
        13543,
        13544,
        13546,
        13550,
        13559,
        13560,
        13561,
        13563,
        13564,
        13565,
        13568,
        13569,
        13570,
        13571,
        13572,
        13573,
        13574,
        13575,
        13576,
        13577,
        13578,
        13579,
        13580,
        13581,
        13582,
        13583,
        13584,
        13585,
        13586,
        13587,
        13588,
        13589,
        13591,
        13592,
        13593,
        13594,
        13595,
        13596,
        13598,
        13599,
        13600,
        13602,
        13603,
        13604,
        13605,
        13606,
        13607,
        13608,
        13609,
        13610,
        13611,
        13612,
        13613,
        13614,
        13615,
        13616,
        13617,
        13618,
        13619,
        13620,
        13623,
        13624,
        13626,
        13627,
        13628,
        13629,
        13630,
        13631,
        13632,
        13634,
        13638,
        13639,
        13642,
        13643,
        13644,
        13645,
        13646,
        13648,
        13649,
        13650,
        13651,
        13652,
        13653,
        13655,
        13656,
        13657,
        13658,
        13659,
        13660,
        13661,
        13662,
        13663,
        13664,
        13667,
        13668,
        13669,
        13670,
        13671,
        13672,
        13673,
        13677,
        13678,
        13680,
        13681,
        13682,
        13683,
        13684,
        13686,
        13688,
        13690,
        13691,
        13694,
        13696,
        13697,
        13702,
        13703,
        13705,
        13706,
        13708,
        13709,
        13710,
        13711,
        13712,
        13713,
        13714,
        13716,
        13717,
        13718,
        13719,
        13720,
        13721,
        13722,
        13723,
        13724,
        13725,
        13728,
        13729,
        13730,
        13731,
        13732,
        13733,
        13735,
        13736,
        13740,
        13743,
        13744,
        13745,
        13746,
        13747,
        13750,
        13751,
        13752,
        13754,
        13755,
        13756,
        13757,
        13759,
        13760,
        13761,
        13762,
        13763,
        13765,
        13769,
        13770,
        13772,
        13773,
        13774,
        13775,
        13777,
        13778,
        13779,
        13781,
        13782,
        13783,
        13784,
        13785,
        13787,
        13788,
        13789,
        13790,
        13791,
        13792,
        13793,
        13794,
        13795,
        13796,
        13799,
        13801,
        13802,
        13804,
        13805,
        13807,
        13809,
        13812,
        13813,
        13814,
        13816,
        13818,
        13819,
        13820,
        13821,
        13822,
        13823,
        13824,
        13827,
        13828,
        13829,
        13830,
        13831,
        13832,
        13833,
        13834,
        13835,
        13836,
        13837,
        13838,
        13839,
        13840,
        13841,
        13842,
        13843,
        13845,
        13846,
        13847,
        13848,
        13850,
        13851,
        13852,
        13853,
        13854,
        13855,
        13856,
        13857,
        13858,
        13859,
        13860,
        13862,
        13863,
        13864,
        13865,
        13867,
        13868,
        13869,
        13870,
        13871,
        13872,
        13873,
        13874,
        13876,
        13877,
        13878,
        13879,
        13880,
        13881,
        13883,
        13887,
        13888,
        13889,
        13890,
        13892,
        13893,
        13894,
        13896,
        13897,
        13898,
        13899,
        13900,
        13901,
        13903,
        13904,
        13905,
        13906,
        13907,
        13908,
        13910,
        13912,
        13913,
        13915,
        13916,
        13920,
        13921,
        13922,
        13923,
        13924,
        13925,
        13928,
        13930,
        13931,
        13932,
        13935,
        13936,
        13938,
        13939,
        13940,
        13942,
        13943,
        13944,
        13945,
        13946,
        13947,
        13948,
        13951,
        13953,
        13954,
        13956,
        13957,
        13958,
        13959,
        13961,
        13962,
        13963,
        13964,
        13965,
        13966,
        13968,
        13969,
        13971,
        13972,
        13973,
        13974,
        13975,
        13976,
        13979,
        13980,
        13981,
        13982,
        13983,
        13985,
        13986,
        13987,
        13988,
        13989,
        13990,
        13995,
        13996,
        13998,
        13999,
        14000,
        14004,
        14005,
        14006,
        14007,
        14008,
        14009,
        14010,
        14011,
        14013,
        14015,
        14016,
        14017,
        14018,
        14019,
        14023,
        14025,
        14026,
        14027,
        14028,
        14029,
        14031,
        14032,
        14033,
        14034,
        14035,
        14037,
        14039,
        14040,
        14041,
        14042,
        14043,
        14046,
        14048,
        14049,
        14051,
        14052,
        14053,
        14061,
        14062,
        14063,
        14064,
        14065,
        14066,
        14070,
        14073,
        14074,
        14075,
        14076,
        14077,
        14078,
        14079,
        14082,
        14083,
        14084,
        14085,
        14087,
        14090,
        14092,
        14093,
        14094,
        14095,
        14096,
        14098,
        14099,
        14100,
        14102,
        14104,
        14105,
        14106,
        14107,
        14108,
        14109,
        14111,
        14112,
        14113,
        14114,
        14116,
        14118,
        14120,
        14122,
        14123,
        14125,
        14127,
        14128,
        14130,
        14131,
        14132,
        14133,
        14134,
        14135,
        14136,
        14137,
        14142,
        14143,
        14144,
        14145,
        14146,
        14147,
        14148,
        14149,
        14150,
        14152,
        14153,
        14156,
        14157,
        14158,
        14159,
        14160,
        14161,
        14164,
        14165,
        14166,
        14168,
        14169,
        14170,
        14171,
        14172,
        14173,
        14175,
        14176,
        14178,
        14179,
        14180,
        14181,
        14183,
        14184,
        14186,
        14187,
        14188,
        14189,
        14190,
        14191,
        14193,
        14194,
        14195,
        14196,
        14197,
        14199,
        14200,
        14202,
        14204,
        14205,
        14206,
        14207,
        14208,
        14209,
        14211,
        14212,
        14213,
        14215,
        14216,
        14218,
        14219,
        14221,
        14222,
        14223,
        14224,
        14225,
        14229,
        14232,
        14233,
        14234,
        14235,
        14236,
        14237,
        14239,
        14243,
        14244,
        14245,
        14247,
        14248,
        14249,
        14250,
        14252,
        14254,
        14258,
        14260,
        14261,
        14262,
        14263,
        14264,
        14265,
        14266,
        14267,
        14268,
        14269,
        14270,
        14271,
        14272,
        14273,
        14274,
        14276,
        14277,
        14279,
        14280,
        14283,
        14284,
        14285,
        14287,
        14288,
        14290,
        14291,
        14292,
        14293,
        14294,
        14295,
        14296,
        14297,
        14298,
        14299,
        14300,
        14303,
        14304,
        14305,
        14306,
        14308,
        14309,
        14311,
        14312,
        14313,
        14314,
        14315,
        14316,
        14317,
        14318,
        14319,
        14320,
        14321,
        14322,
        14323,
        14324,
        14325,
        14327,
        14328,
        14329,
        14330,
        14331,
        14333,
        14334,
        14335,
        14336,
        14337,
        14339,
        14340,
        14341,
        14342,
        14344,
        14345,
        14346,
        14347,
        14348,
        14349,
        14350,
        14351,
        14352,
        14354,
        14355,
        14356,
        14358,
        14359,
        14360,
        14361,
        14362,
        14364,
        14366,
        14368,
        14369,
        14372,
        14375,
        14376,
        14377,
        14378,
        14379,
        14380,
        14381,
        14382,
        14383,
        14384,
        14385,
        14386,
        14388,
        14389,
        14390,
        14391,
        14392,
        14393,
        14394,
        14396,
        14398,
        14401,
        14404,
        14405,
        14407,
        14408,
        14409,
        14410,
        14411,
        14413,
        14415,
        14416,
        14418,
        14419,
        14421,
        14422,
        14423,
        14427,
        14428,
        14429,
        14430,
        14431,
        14432,
        14433,
        14434,
        14436,
        14437,
        14438,
        14439,
        14440,
        14441,
        14442,
        14448,
        14449,
        14450,
        14451,
        14452,
        14453,
        14454,
        14455,
        14456,
        14457,
        14458,
        14461,
        14462,
        14463,
        14464,
        14465,
        14466,
        14467,
        14468,
        14470,
        14471,
        14472,
        14473,
        14474,
        14475,
        14476,
        14478,
        14481,
        14482,
        14483,
        14484,
        14485,
        14486,
        14487,
        14488,
        14489,
        14490,
        14493,
        14494,
        14495,
        14496,
        14499,
        14500,
        14501,
        14502,
        14503,
        14504,
        14506,
        14507,
        14508,
        14509,
        14513,
        14514,
        14515,
        14516,
        14518,
        14519,
        14521,
        14522,
        14525,
        14526,
        14527,
        14528,
        14529,
        14531,
        14532,
        14535,
        14536,
        14537,
        14538,
        14541,
        14542,
        14545,
        14547,
        14548,
        14549,
        14550,
        14551,
        14553,
        14554,
        14555,
        14556,
        14557,
        14558,
        14559,
        14560,
        14561,
        14562,
        14563,
        14565,
        14567,
        14568,
        14571,
        14572,
        14573,
        14575,
        14577,
        14578,
        14579,
        14580,
        14581,
        14583,
        14584,
        14591,
        14593,
        14594,
        14595,
        14598,
        14599,
        14600,
        14601,
        14602,
        14603,
        14604,
        14606,
        14607,
        14608,
        14609,
        14610,
        14613,
        14614,
        14616,
        14619,
        14620,
        14623,
        14624,
        14625,
        14626,
        14627,
        14628,
        14629,
        14630,
        14631,
        14632,
        14633,
        14634,
        14637,
        14638,
        14639,
        14640,
        14641,
        14642,
        14643,
        14644,
        14645,
        14646,
        14647,
        14648,
        14650,
        14651,
        14653,
        14654,
        14655,
        14656,
        14657,
        14658,
        14660,
        14662,
        14664,
        14665,
        14666,
        14668,
        14670,
        14671,
        14672,
        14673,
        14676,
        14677,
        14679,
        14680,
        14681,
        14682,
        14683,
        14684,
        14685,
        14686,
        14688,
        14690,
        14693,
        14694,
        14695,
        14696,
        14697,
        14698,
        14700,
        14704,
        14707,
        14708,
        14710,
        14712,
        14713,
        14714,
        14716,
        14718,
        14719,
        14721,
        14723,
        14724,
        14726,
        14729,
        14731,
        14732,
        14733,
        14734,
        14735,
        14736,
        14737,
        14738,
        14739,
        14740,
        14741,
        14742,
        14745,
        14746,
        14748,
        14749,
        14751,
        14752,
        14753,
        14754,
        14755,
        14756,
        14757,
        14758,
        14759,
        14760,
        14761,
        14762,
        14763,
        14764,
        14765,
        14766,
        14768,
        14769,
        14770,
        14771,
        14772,
        14774,
        14775,
        14776,
        14777,
        14778,
        14779,
        14780,
        14781,
        14782,
        14783,
        14784,
        14785,
        14786,
        14788,
        14789,
        14790,
        14791,
        14792,
        14794,
        14795,
        14796,
        14797,
        14799,
        14800,
        14801,
        14804,
        14805,
        14806,
        14807,
        14809,
        14810,
        14811,
        14812,
        14814,
        14815,
        14816,
        14818,
        14819,
        14820,
        14821,
        14822,
        14824,
        14825,
        14826,
        14827,
        14828,
        14829,
        14830,
        14831,
        14832,
        14833,
        14834,
        14835,
        14836,
        14838,
        14839,
        14840,
        14841,
        14842,
        14843,
        14844,
        14846,
        14847,
        14848,
        14849,
        14852,
        14853,
        14854,
        14855,
        14856,
        14857,
        14858,
        14859,
        14860,
        14861,
        14862,
        14863,
        14865,
        14866,
        14867,
        14869,
        14870,
        14871,
        14872,
        14873,
        14874,
        14875,
        14876,
        14877,
        14879,
        14881,
        14882,
        14883,
        14884,
        14885,
        14886,
        14887,
        14889,
        14890,
        14892,
        14893,
        14894,
        14895,
        14896,
        14897,
        14898,
        14899,
        14900,
        14901,
        14903,
        14904,
        14906,
        14908,
        14910,
        14912,
        14913,
        14915,
        14917,
        14918,
        14919,
        14920,
        14921,
        14922,
        14923,
        14924,
        14925,
        14926,
        14927,
        14928,
        14931,
        14933,
        14934,
        14935,
        14936,
        14937,
        14938,
        14940,
        14941,
        14942,
        14943,
        14944,
        14946,
        14947,
        14948,
        14949,
        14951,
        14953,
        14959,
        14960,
        14966,
        14967,
        14973,
        14974,
        14978,
        14979,
        14980,
        14981,
        14984,
        14987,
        14988,
        14989,
        14991,
        14992,
        14999,
        15003,
        15006,
        15007,
        15008,
        15011,
        15013,
        15017,
        15019,
        15023,
        15024,
        15026,
        15027,
        15030,
        15031,
        15032,
        15038,
        15040,
        15041,
        15043,
        15047,
        15049,
        15050,
        15053,
        15054,
        15058,
        15059,
        15061,
        15062,
        15063,
        15068,
        15069,
        15078,
        15081,
        15082,
        15084,
        15085,
        15087,
        15090,
        15091,
        15094,
        15096,
        15097,
        15099,
        15101,
        15102,
        15103,
        15104,
        15106,
        15108,
        15111,
        15112,
        15113,
        15115,
        15116,
        15118,
        15119,
        15121,
        15124,
        15127,
        15128,
        15133,
        15138,
        15139,
        15140,
        15141,
        15143,
        15148,
        15149,
        15152,
        15154,
        15157,
        15161,
        15163,
        15166,
        15167,
        15168,
        15169,
        15170,
        15172,
        15174,
        15178,
        15179,
        15180,
        15181,
        15182,
        15183,
        15184,
        15185,
        15186,
        15188,
        15191,
        15193,
        15196,
        15197,
        15198,
        15199,
        15202,
        15203,
        15204,
        15206,
        15207,
        15211,
        15213,
        15214,
        15215,
        15216,
        15217,
        15218,
        15219,
        15220,
        15221,
        15222,
        15223,
        15224,
        15225,
        15226,
        15227,
        15231,
        15232,
        15233,
        15234,
        15235,
        15236,
        15237,
        15239,
        15240,
        15241,
        15243,
        15244,
        15245,
        15248,
        15249,
        15250,
        15251,
        15255,
        15257,
        15261,
        15262,
        15263,
        15268,
        15272,
        15274,
        15276,
        15278,
        15280,
        15284,
        15285,
        15291,
        15294,
        15296,
        15297,
        15302,
        15304,
        15305,
        15309,
        15310,
        15311,
        15312,
        15313,
        15314,
        15315,
        15316,
        15318,
        15319,
        15324,
        15325,
        15326,
        15327,
        15333,
        15334,
        15335,
        15336,
        15337,
        15338,
        15339,
        15340,
        15343,
        15344,
        15345,
        15346,
        15350,
        15351,
        15352,
        15356,
        15357,
        15358,
        15359,
        15361,
        15362,
        15364,
        15365,
        15366,
        15367,
        15369,
        15370,
        15371,
        15372,
        15374,
        15375,
        15376,
        15378,
        15379,
        15380,
        15381,
        15382,
        15383,
        15384,
        15385,
        15386,
        15387,
        15389,
        15390,
        15391,
        15392,
        15393,
        15394,
        15397,
        15398,
        15399,
        15400,
        15401,
        15403,
        15407,
        15411,
        15412,
        15415,
        15422,
        15423,
        15426,
        15430,
        15434,
        15435,
        15436,
        15439,
        15445,
        15446,
        15450,
        15452,
        15453,
        15454,
        15455,
        15458,
        15459,
        15460,
        15461,
        15465,
        15467,
        15471,
        15472,
        15473,
        15477,
        15478,
        15483,
        15485,
        15486,
        15487,
        15488,
        15490,
        15492,
        15494,
        15499,
        15502,
        15503,
        15504,
        15507,
        15509,
        15510,
        15511,
        15512,
        15513,
        15514,
        15516,
        15523,
        15525,
        15527,
        15528,
        15530,
        15531,
        15532,
        15533,
        15535,
        15536,
        15537,
        15538,
        15540,
        15541,
        15543,
        15544,
        15546,
        15547,
        15549,
        15553,
        15555,
        15558,
        15560,
        15561,
        15562,
        15563,
        15564,
        15565,
        15566,
        15570,
        15577,
        15578,
        15581,
        15587,
        15589,
        15590,
        15591,
        15595,
        15598,
        15599,
        15600,
        15601,
        15603,
        15606,
        15609,
        15610,
        15611,
        15615,
        15617,
        15618,
        15619,
        15620,
        15621,
        15622,
        15623,
        15624,
        15625,
        15626,
        15627,
        15628,
        15629,
        15630,
        15633,
        15634,
        15635,
        15637,
        15638,
        15639,
        15640,
        15642,
        15643,
        15644,
        15645,
        15646,
        15647,
        15650,
        15651,
        15652,
        15653,
        15654,
        15655,
        15656,
        15657,
        15658,
        15660,
        15661,
        15662,
        15663,
        15664,
        15665,
        15666,
        15667,
        15668,
        15669,
        15673,
        15674,
        15677,
        15679,
        15683,
        15684,
        15685,
        15686,
        15691,
        15692,
        15695,
        15700,
        15702,
        15703,
        15708,
        15713,
        15714,
        15717,
        15719,
        15721,
        15722,
        15724,
        15725,
        15728,
        15733,
        15734,
        15735,
        15738,
        15739,
        15744,
        15745,
        15747,
        15750,
        15751,
        15753,
        15754,
        15756,
        15759,
        15763,
        15765,
        15766,
        15770,
        15771,
        15772,
        15775,
        15778,
        15780,
        15782,
        15783,
        15785,
        15786,
        15792,
        15793,
        15794,
        15798,
        15800,
        15801,
        15802,
        15803,
        15804,
        15805,
        15806,
        15807,
        15808,
        15809,
        15812,
        15814,
        15816,
        15817,
        15818,
        15820,
        15821,
        15823,
        15824,
        15825,
        15827,
        15828,
        15829,
        15830,
        15832,
        15833,
        15834,
        15835,
        15836,
        15837,
        15839,
        15840,
        15845,
        15848,
        15850,
        15854,
        15855,
        15856,
        15861,
        15863,
        15864,
        15866,
        15870,
        15871,
        15874,
        15879,
        15880,
        15881,
        15882,
        15883,
        15885,
        15888,
        15889,
        15890,
        15894,
        15895,
        15896,
        15899,
        15900,
        15902,
        15903,
        15904,
        15905,
        15907,
        15908,
        15912,
        15913,
        15914,
        15915,
        15916,
        15918,
        15919,
        15921,
        15923,
        15925,
        15928,
        15930,
        15931,
        15932,
        15934,
        15936,
        15937,
        15942,
        15947,
        15952,
        15958,
        15959,
        15960,
        15961,
        15962,
        15965,
        15966,
        15968,
        15969,
        15971,
        15973,
        15974,
        15975,
        15978,
        15979,
        15982,
        15984,
        15985,
        15988,
        15989,
        15990,
        15991,
        15992,
        15993,
        15998,
        15999,
        16002,
        16004,
        16005,
        16007,
        16009,
        16011,
        16013,
        16014,
        16015,
        16018,
        16020,
        16021,
        16022,
        16023,
        16024,
        16026,
        16027,
        16029,
        16031,
        16037,
        16039,
        16042,
        16043,
        16044,
        16045,
        16046,
        16048,
        16050,
        16054,
        16057,
        16058,
        16059,
        16061,
        16065,
        16066,
        16067,
        16068,
        16070,
        16071,
        16074,
        16075,
        16080,
        16082,
        16083,
        16084,
        16085,
        16087,
        16090,
        16092,
        16095,
        16096,
        16097,
        16098,
        16100,
        16101,
        16102,
        16106,
        16108,
        16109,
        16112,
        16114,
        16116,
        16117,
        16119,
        16121,
        16122,
        16123,
        16125,
        16126,
        16129,
        16133,
        16135,
        16137,
        16138,
        16139,
        16141,
        16142,
        16143,
        16144,
        16145,
        16147,
        16152,
        16154,
        16159,
        16160,
        16161,
        16162,
        16166,
        16167,
        16170,
        16171,
        16173,
        16177,
        16179,
        16180,
        16181,
        16183,
        16184,
        16185,
        16186,
        16187,
        16188,
        16192,
        16193,
        16194,
        16195,
        16196,
        16197,
        16198,
        16199,
        16201,
        16202,
        16204,
        16210,
        16211,
        16214,
        16220,
        16224,
        16225,
        16226,
        16227,
        16228,
        16229,
        16230,
        16231,
        16232,
        16233,
        16234,
        16236,
        16237,
        16240,
        16242,
        16243,
        16244,
        16248,
        16249,
        16253,
        16254,
        16256,
        16258,
        16260,
        16262,
        16263,
        16264,
        16269,
        16270,
        16271,
        16273,
        16274,
        16279,
        16283,
        16291,
        16292,
        16294,
        16295,
        16296,
        16299,
        16302,
        16304,
        16309,
        16311,
        16315,
        16318,
        16321,
        16322,
        16323,
        16324,
        16325,
        16327,
        16328,
        16334,
        16337,
        16340,
        16341,
        16342,
        16345,
        16348,
        16350,
        16353,
        16354,
        16356,
        16359,
        16360,
        16362,
        16365,
        16366,
        16368,
        16371,
        16378,
        16379,
        16380,
        16381,
        16382,
        16383,
        16386,
        16388,
        16389,
        16390,
        16391,
        16392,
        16393,
        16394,
        16400,
        16403,
        16405,
        16409,
        16412,
        16414,
        16415,
        16416,
        16418,
        16420,
        16424,
        16425,
        16426,
        16427,
        16428,
        16431,
        16433,
        16434,
        16437,
        16442,
        16444,
        16445,
        16446,
        16448,
        16450,
        16451,
        16452,
        16453,
        16457,
        16458,
        16459,
        16460,
        16462,
        16463,
        16464,
        16468,
        16473,
        16476,
        16478,
        16481,
        16483,
        16484,
        16485,
        16486,
        16490,
        16492,
        16493,
        16495,
        16497,
        16498,
        16499,
        16500,
        16502,
        16503,
        16504,
        16505,
        16506,
        16507,
        16510,
        16511,
        16512,
        16515,
        16516,
        16518,
        16519,
        16520,
        16523,
        16525,
        16534,
        16535,
        16536,
        16537,
        16538,
        16540,
        16541,
        16542,
        16543,
        16547,
        16548,
        16550,
        16551,
        16552,
        16553,
        16554,
        16555,
        16556,
        16561,
        16566,
        16567,
        16569,
        16572,
        16575,
        16577,
        16578,
        16579,
        16580,
        16584,
        16588,
        16594,
        16595,
        16596,
        16598,
        16600,
        16604
    ]?.reverse();
        function splitArrayIntoChunks(arr, chunkSize = 10) {
            const result = [];
            for (let i = 0; i < arr.length; i += chunkSize) {
                result.push(arr.slice(i, i + chunkSize));
            }
            return result;
        }
        //获取总条数
        const orderIdDatas = splitArrayIntoChunks(orderIds, 1000);
        // const res = await this.getData();
        // const count = res?.data?.count
        const totalPages = orderIdDatas?.length;
        console.log(`----------总计${totalPages}页----------`)
        for (let page = 0; page < totalPages; page++) {
            console.log(`----------当前${page}----------`)
            const list = await this.getData(orderIdDatas[page]);
            list?.data?.forEach(item => {
                let arr = fields.map(field => {
                    return item[field]
                });
                data.push(arr);
            })

        }
        let excelData = [
            {
                name: "开工统计",//sheet名字
                data: data
            },
        ];
        const buffer = xlsx.build(excelData);
        fs.writeFileSync('./开工统计.xlsx', buffer);//第一个就是文件的名字
        console.log('文件生成成功');
    }
    async getJson() {
        const { ctx } = this;
        const body = ctx.request.body

        this.aaaa()
        return 666

    }
}

module.exports = ApiController;
